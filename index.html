<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Worldwide Logistics Services.">
    <meta name="keywords" content="armenia quindio, compra, venta, clasificados, productos, Colombia, Contraentrega">
    <meta name="robots" content="index, follow">
    <meta name="author" content="Contraentrega">
    <meta property="og:title" content="@armeniaquindio - Compra y venta en Armenia Quindío">
    <meta property="og:description" content="Compra y venta en Armenia Quindío, Colombia. Publica tus productos en Contraentrega.">
    <meta property="og:image" content="URL-de-tu-imagen">
    <meta property="og:url" content="https://www.tusitio.com">
    <meta property="og:type" content="website">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="@armeniaquindio - Compra y venta en Armenia Quindío">
    <meta name="twitter:description" content="Compra y venta en Armenia Quindío, Colombia. Publica tus productos en Contraentrega.">
    <meta name="twitter:image" content="URL-de-tu-imagen">
    <meta name="twitter:url" content="https://www.tusitio.com">
    <meta name="google-site-verification" content="your-verification-code" />

<!-- Facebook Pixel -->
  <script>
    !function(f,b,e,v,n,t,s)
    {if(f.fbq)return;n=f.fbq=function(){n.callMethod?
    n.callMethod.apply(n,arguments):n.queue.push(arguments)};
    if(!f._fbq)f._fbq=n;n.push=n;n.loaded=!0;n.version='2.0';
    n.queue=[];t=b.createElement(e);t.async=!0;
    t.src=v;s=b.getElementsByTagName(e)[0];
    s.parentNode.insertBefore(t,s)}(window, document,'script',
    'https://connect.facebook.net/en_US/fbevents.js');
    fbq('init', 'your-pixel-id');
    fbq('track', 'PageView');
  </script>
  <noscript>
    <img height="1" width="1" style="display:none"
    src="https://www.facebook.com/tr?id=your-pixel-id&ev=PageView&noscript=1"/>
  </noscript>
  <!-- End Facebook Pixel -->
</head>

    
    <title>@armeniaquindio - Compra y venta en Armenia Quindío</title>

    <!-- Datos estructurados con Schema.org -->
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "WebSite",
        "url": "https://www.tusitio.com",
        "name": "@armeniaquindio",
        "description": "Compra y venta en Armenia Quindío, Colombia. Publica tus productos en Contraentrega.",
        "publisher": {
            "@type": "Organization",
            "name": "Contraentrega Armenia Quindío"
        }
    }
 </script>

    <!-- Favicon -->
    <link rel="icon" href="URL-del-favicon" type="image/png">

    <!-- Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=YOUR_TRACKING_ID"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'YOUR_TRACKING_ID');
    </script>

    <style>
        body {
            font-family: Arial, sans-serif;
            background-color: #f1f1f1;
            margin: 0;
            padding: 0;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            text-align: center;
        }
        .container {
            background-color: #ffffff;
            border-radius: 8px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            width: 90%; 
            max-width: 600px; 
            padding: 20px;
            overflow-y: auto; 
            max-height: 80vh; 
            height: 100%; 
        }
        h1, h2 {
            font-size: 2.5em;
            color: #333;
            margin-bottom: 10px;
        }
        p {
            color: #666;
            font-size: 1.2em;
            margin-bottom: 20px;
        }
        .buttons a {
            display: block;
            background-color: #000000;
            color: white;
            padding: 10px;
            margin: 5px 0;
            text-decoration: none;
            border-radius: 5px;
            font-size: 1em;
            transition: background-color 0.3s;
        }
        .buttons a:hover {
            background-color: #333333;
        }
        .footer {
            font-size: 0.9em;
            color: #777;
            margin-top: 20px;
        }
        form {
            margin-top: 20px;
            text-align: left;
            margin-bottom: 20px;
        }
        input[type="text"], input[type="number"], textarea {
            width: 100%;
            padding: 10px;
            margin: 10px 0;
            border: 1px solid #ccc;
            border-radius: 5px;
        }
        input[type="file"] {
            margin: 10px 0;
        }
        button {
            background-color: #000000;
            color: white;
            padding: 10px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 1.1em;
            width: 100%;
        }
        button:hover {
            background-color: #333333;
        }
        table {
            width: 100%;
            margin-top: 30px;
            border-collapse: collapse;
            overflow-x: auto;
        }
        th, td {
            padding: 10px;
            text-align: left;
            border: 1px solid #ccc;
        }
        th {
            background-color: #f4f4f4;
        }
        td {
            background-color: #fafafa;
        }
        h2 {
            font-size: 1.8em;
            color: #333;
            margin-top: 20px;
        }

        .clickable {
            color: #007BFF;
            text-decoration: underline;
            cursor: pointer;
            transition: color 0.3s ease-in-out;
        }

        .clickable:hover {
            color: #0056b3;
            text-decoration: none;
        }

        /* Lazy loading de imágenes */
        img[loading="lazy"] {
            opacity: 0;
            transition: opacity 0.3s ease-in;
        }
        img[loading="lazy"]:not([src=""]) {
            opacity: 1;
        }
    </style>

  <!-- Google Tag Manager -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=GTM-XXXXXX"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'GTM-XXXXXX');
  </script>
  <!-- End Google Tag Manager -->
</head>

<body>

    <div class="container">
        <header>
            <h1>@campoalegrecali</h1>
            <p>	Local: Vereda Campoalegre, Oeste Cali, Valle, Colombia</p>
        </header>

        <!-- Enlaces -->
        <div class="buttons">
            <a href="https://wa.me/573215970535" target="_blank">MENSAJE</a>
            <a href="tel:+573215970535" target="_blank">LLAMAR</a>
        </div>
   
    
    
    <!-- Buscador de contactos -->
<form onsubmit="searchContacts(); return false;">
    <div class="search-bar">
        <input type="text" id="searchContactInput" placeholder="Buscar inventario...">
        <button type="submit">Buscar</button>
    </div>
</form>

        
<!-- Contactos -->
        <section>
            <h2>Inventario</h2>
            <table>
                <thead>
                    <tr>
                        <th>Código</th>
                        <th>Nombre</th>
                        <th>Ubicación</th>
                        <th>Detalles</th>
                        <th>Precio</th>
                        <th>Stock</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><a href="sku-1/sku-1-18L4LbBf3e9Udq7zobRPVah3CBfvDRMaZCcuj5As8xHbgJ4rzKvBvZH1.html" class="clickable" target="_blank" rel="noopener noreferrer">1</a></td>
                        <td>Juguetería, Piñatería, Hogar, Salud y Belleza</td>
                        <td>-</td>
                        <td>+573105938658</td>
                        <td>-</td>
                        <td>-</td>
                    </tr>
<tr>
                        <td><a href="" class="clickable" target="_blank" rel="noopener noreferrer">2</a></td>
                        <td>DJ</td>
                        <td>-</td>
                        <td>+573215340988</td>
                        <td>-</td>
                        <td>-</td>
                    </tr>
<tr>
                        <td><a href="https://co.contraentregaco.com/collections/18jcpm" class="clickable" target="_blank" rel="noopener noreferrer">3</a></td>
                        <td>DJ</td>
                        <td>-</td>
                        <td>+573215340988</td>
                        <td>-</td>
                        <td>-</td>
                    </tr>
                </tbody>
            </table>
        </section>

<!-- lnurl -->
<a id="lnurl" href="#">Generar factura</a>
<script>generarFacturaLNURL(10000);</script>


<!-- oferta -->
<p id="ultimaOferta">No hay ofertas aún.</p>
<input type="number" id="montoOferta" placeholder="Ingrese BTC">
<button onclick="hacerOferta(document.getElementById('montoOferta').value)">Ofertar</button>


<!-- xmpp -->
<input type="text" id="mensaje" placeholder="Escribe tu mensaje">
<button onclick="enviarMensaje('vendedor@tu-servidor-xmpp.com', document.getElementById('mensaje').value)">Enviar</button>


<!-- recarga -->
<button onclick="recargarSaldo(10000)">Recargar 10,000 Satoshis</button>


<!-- nostr -->
<button onclick="loginConNostr()">Iniciar sesión con Nostr</button>


<!-- referido -->
<input type="text" id="enlaceReferido" readonly>
<button onclick="navigator.clipboard.writeText(document.getElementById('enlaceReferido').value)">Copiar Enlace</button>


<!-- nfc -->
<button onclick="pagarConNFC()">Pagar con NFC</button>


<!-- metamask -->
<button onclick="pagarConMetaMask()">Pagar con MetaMask</button>
            <!-- Footer -->
        <footer class="footer">
            <p>&copy; <span id="year"></span> <strong>Cordientrega</strong></p>
            <p>Bitcoin: <a href="bitcoin:15gdaABbh6oZZG4kfQPXoSdqj9YMsg5RaH" target="_blank" rel="noopener noreferrer">15gdaABbh6oZZG4kfQPXoSdqj9YMsg5RaH</a></p>
        </footer>
    </div>

<script>
// Lista de precios en COP para cada producto
const preciosCOP = {
    producto1: 500000,  // Precio en COP del producto 1
    producto2: 10000000, // Precio en COP del producto 2
    producto3: 150000,  // Precio en COP del producto 3
    producto4: 500000   // Precio en COP del producto 4
};

// API para obtener precios de Bitcoin y tasa de cambio COP a USD
const COINGECKO_API = "https://api.coingecko.com/api/v3/simple/price?ids=bitcoin&vs_currencies=usd,cop";

// Función para obtener el precio de BTC en USD y la tasa de conversión COP a USD
async function obtenerDatosDeMercado() {
    try {
        const response = await fetch(COINGECKO_API);
        const data = await response.json();
        return {
            precioBTC: data.bitcoin.usd,  // Precio de 1 BTC en USD
            tasaCOPaUSD: data.bitcoin.cop // Precio de 1 USD en COP
        };
    } catch (error) {
        console.error("Error obteniendo datos del mercado:", error);
        return null;
    }
}

// Función para calcular el precio en satoshis basado en COP
async function calcularPrecioLightning(cop) {
    const datosMercado = await obtenerDatosDeMercado();
    if (!datosMercado) {
        console.error("No se pudieron obtener datos del mercado.");
        return null;
    }

    const precioUSD = cop / datosMercado.tasaCOPaUSD; // Convertimos COP a USD
    const montoBTC = precioUSD / datosMercado.precioBTC; // Convertimos USD a BTC
    const montoSatoshis = Math.round(montoBTC * 100000000); // Convertimos BTC a satoshis

    return montoSatoshis;
}

// Función para generar un enlace de pago Lightning (personalizar según el sistema que uses)
function generarEnlaceLightning(satoshis) {
    return `lightning:lnbc${satoshis}0n1p...`; // Aquí debes integrar con tu nodo Lightning
}

// Función para actualizar los precios y enlaces Lightning en la página
async function actualizarPrecios() {
    for (const [producto, precioCOP] of Object.entries(preciosCOP)) {
        const precioLightning = await calcularPrecioLightning(precioCOP);
        if (precioLightning !== null) {
            // Actualizamos el precio en el HTML
            const precioElement = document.getElementById(`precio-lightning-${producto}`);
            if (precioElement) {
                precioElement.innerText = `Precio en Lightning: ${precioLightning} satoshis`;
            }

            // Actualizamos el enlace de pago
            const linkElement = document.getElementById(`link-lightning-${producto}`);
            if (linkElement) {
                linkElement.setAttribute('href', generarEnlaceLightning(precioLightning));
            }
        }
    }
}

// Llamamos a la función para actualizar los precios al cargar la página
document.addEventListener("DOMContentLoaded", actualizarPrecios);

// Función para filtrar la tabla de inventario en tiempo real
function searchContacts() {
    const input = document.getElementById("searchContactInput").value.toLowerCase();
    const table = document.querySelector("table tbody");
    const rows = table.getElementsByTagName("tr");

    for (let row of rows) {
        const text = row.innerText.toLowerCase();
        row.style.display = text.includes(input) ? "" : "none";
    }
}

async function generarFacturaLNURL(montoSatoshis) {
    const endpoint = "https://lnbits.com/api/v1/payments"; // Modifica con tu endpoint real
    const response = await fetch(endpoint, {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ amount: montoSatoshis, memo: "Compra en e-commerce" })
    });
    const data = await response.json();
    if (data.payment_request) {
        document.getElementById("lnurl").href = `lightning:${data.payment_request}`;
        document.getElementById("lnurl").innerText = "Pagar con Lightning";
    }
}

const socket = new WebSocket("wss://tu-nodo-lnd.com/ws"); // Reemplaza con tu nodo

socket.onmessage = (event) => {
    const data = JSON.parse(event.data);
    if (data.type === "payment_received") {
        alert(`Pago recibido: ${data.amount} satoshis`);
        location.reload();
    }
};

async function enviarNotificacionTelegram(mensaje) {
    const token = "TU_TELEGRAM_BOT_TOKEN";
    const chatId = "TU_CHAT_ID";
    const url = `https://api.telegram.org/bot${token}/sendMessage`;

    await fetch(url, {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ chat_id: chatId, text: mensaje })
    });
}

const socket = new WebSocket("wss://tu-nodo-lnd.com/ws"); // WebSocket de LND

socket.onmessage = async (event) => {
    const data = JSON.parse(event.data);
    if (data.type === "payment_received") {
        const mensaje = `Pago recibido: ${data.amount} satoshis en Lightning Network`;
        await enviarNotificacionTelegram(mensaje);
    }
};

async function generarFacturaYConfirmar(montoSatoshis) {
    const endpoint = "https://tu-servidor-lnd.com/api/v1/payments"; // Cambia con tu API LNBits
    const response = await fetch(endpoint, {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ amount: montoSatoshis, memo: "Compra en e-commerce" })
    });
    const data = await response.json();

    if (data.payment_request) {
        document.getElementById("lnurl").href = `lightning:${data.payment_request}`;
        document.getElementById("lnurl").innerText = "Pagar con Lightning";
    }

    // Escuchar la confirmación de pago
    const socket = new WebSocket(`wss://tu-servidor-lnd.com/ws/${data.payment_hash}`);
    socket.onmessage = (event) => {
        const pago = JSON.parse(event.data);
        if (pago.settled) {
            alert("Pago confirmado en Lightning!");
            location.reload();
        }
    };
}

document.addEventListener("DOMContentLoaded", () => generarFacturaYConfirmar(10000));

async function enviarEventoNostr(pubkey, mensaje) {
    const nostrEvento = {
        kind: 1,
        created_at: Math.floor(Date.now() / 1000),
        tags: [["p", pubkey]],
        content: mensaje
    };

    if (window.nostr) {
        await window.nostr.signEvent(nostrEvento);
        const relays = ["wss://relay.damus.io"];
        relays.forEach((relay) => {
            const ws = new WebSocket(relay);
            ws.onopen = () => ws.send(JSON.stringify(["EVENT", nostrEvento]));
        });
    } else {
        alert("Nostr no está disponible.");
    }
}

// Simulación de pago recibido
const pagoRecibido = {
    pubkey: "npub1example...",
    amount: 10000
};

enviarEventoNostr(pagoRecibido.pubkey, `Has recibido ${pagoRecibido.amount} satoshis! ⚡`);

const socket = new WebSocket("wss://tu-servidor.com/subasta");

function hacerOferta(monto) {
    socket.send(JSON.stringify({ tipo: "oferta", usuario: "Usuario123", monto }));
}

socket.onmessage = (event) => {
    const data = JSON.parse(event.data);
    if (data.tipo === "nueva_oferta") {
        document.getElementById("ultimaOferta").innerText = `${data.usuario} ofertó ${data.monto} BTC`;
    }
};

const BOSH_SERVICE = "https://tu-servidor-xmpp.com/http-bind/";
const XMPP_DOMAIN = "tu-servidor-xmpp.com";
const usuario = "comprador@tu-servidor-xmpp.com";
const password = "clave123";

const connection = new Strophe.Connection(BOSH_SERVICE);

function conectarXMPP() {
    connection.connect(usuario, password, (status) => {
        if (status === Strophe.Status.CONNECTED) {
            console.log("Conectado a XMPP");
            connection.addHandler(recibirMensaje, null, "message", "chat");
        } else if (status === Strophe.Status.AUTHFAIL) {
            console.log("Fallo en la autenticación");
        }
    });
}

function recibirMensaje(msg) {
    const from = msg.getAttribute("from");
    const body = msg.getElementsByTagName("body")[0].textContent;
    console.log(`Mensaje de ${from}: ${body}`);
    return true;
}

function enviarMensaje(destinatario, mensaje) {
    const reply = $msg({ to: destinatario, type: "chat" }).c("body").t(mensaje);
    connection.send(reply);
}

document.addEventListener("DOMContentLoaded", conectarXMPP);

async function recargarSaldo(montoSatoshis) {
    const response = await fetch("/api/crear-lnurl", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ amount: montoSatoshis })
    });

    const data = await response.json();
    if (data.lnurl) {
        window.location.href = `lightning:${data.lnurl}`;
    }
}

async function publicarEnNostr(producto) {
    const evento = {
        kind: 1,
        created_at: Math.floor(Date.now() / 1000),
        tags: [["e", "publicaciones"]],
        content: `🛒 Nuevo producto: ${producto.nombre} - ${producto.precio} sats ⚡`
    };

    if (window.nostr) {
        await window.nostr.signEvent(evento);
        const relay = new WebSocket("wss://relay.damus.io");
        relay.onopen = () => relay.send(JSON.stringify(["EVENT", evento]));
    }
}

const nuevoProducto = { nombre: "Camiseta Bitcoin", precio: 50000 };
publicarEnNostr(nuevoProducto);

function generarEnlaceReferido() {
    const usuarioId = "user123"; // Este ID debe ser dinámico según el usuario autenticado
    const enlaceReferido = `${window.location.origin}/?ref=${usuarioId}`;
    document.getElementById("enlaceReferido").value = enlaceReferido;
}

document.addEventListener("DOMContentLoaded", generarEnlaceReferido);

async function registrarCompra() {
    const params = new URLSearchParams(window.location.search);
    const referido = params.get("ref");

    if (referido) {
        await fetch("/api/registrar-referido", {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify({ referido, monto: 5000 }) // 5000 Satoshis de recompensa
        });
    }
}

document.addEventListener("DOMContentLoaded", registrarCompra);

async function pagarConNFC() {
    if (!("NDEFReader" in window)) {
        alert("Tu dispositivo no soporta NFC.");
        return;
    }

    const nfc = new NDEFReader();
    await nfc.write("lightning:lnurlp_tu_codigo");

    alert("Pago procesado con Lightning NFC.");
}

async function pagarConMetaMask() {
    if (!window.ethereum) {
        alert("Instala MetaMask para continuar.");
        return;
    }

    const accounts = await ethereum.request({ method: "eth_requestAccounts" });
    const direccion = accounts[0];

    await ethereum.request({
        method: "eth_sendTransaction",
        params: [{ from: direccion, to: "DIRECCION_BTC", value: "10000000000000000" }]
    });

    alert("Pago enviado.");
}

// Actualizar el año en el footer automáticamente
document.getElementById("year").innerText = new Date().getFullYear();

</script>

</body>
</html>
